\begin{center}
    \section{Семинар VII}
\end{center}
\subsection{Трёхмерное пространство.}
Всё хорошее когда-нибудь заканчивается и настаёт пора суровой реальной жизни. Так и для нас самое время переходить к трехмерному пространству. Давайте попробуем разобраться, как изменится подход к описанию систем такого типа.

Так как пространство трёхмерное, мы рассматриваем трёхмерные операторы $\hat{\Vec{r}} = (\hat{x}, \hat{y}, \hat{z})$ и $\hat{\Vec{p}} = (\hat{p}_x, \hat{p}_y, \hat{p}_z)$. Гамильтониан частицы в поле принимает вид:
\[
\hat{H} = \frac{\hat{p}^2_x}{2M} + \frac{\hat{p}^2_y}{2M} + \frac{\hat{p}^2_z}{2M} + V(\Vec{r})
\]
Тогда стационарное уравнение Шрёдингера принимает вид:
\[
\left[\frac{\hat{p}^2}{2M} + V(\Vec{r})\right]\psi(\Vec{r}) = E\psi(\Vec{r})
\]
или, если расписать оператор импульса в координатном представлении:
\[
\left[-\frac{\hbar^2}{2M}\nabla^2 + V(\Vec{r})\right]\psi(\Vec{r}) = E\psi(\Vec{r})
\]
Теперь мы работаем с трёхмерным дифференциальным уравнением в частных производных. Решение этого уравнения в общем виде весьма затруднительно. Поэтому разберём особо важный для физических задач частный случай, а именно -- \textit{центрально -- симметричный потенциал}. В центрально -- симметричном потенциале имеет вид $V(\Vec{r}) = V(r)$, где $r = \sqrt{x^2 + y^2 + z^2}$. Как потом окажется, в этом случае решать трёхмерное уравнение Шрёдингера гораздо удобнее. Но для начала нужно навести немного математики. Начнём с того, что перейдём к сферической системе координат. Делаем мы это, исходя из опыта работы с классическим случаем. Мы хотим разделить потенциал на три отдельные составляющие -- по одной на каждую переменную. Тогда гильбертово пространство будет состоять из тензорного произведения трёх пространств $\mathbf{V} = \mathbf{V}_r\otimes\mathbf{V}_{\theta}\otimes\mathbf{V}_{\phi}$. 

Осуществим переход к сферическим координатам:
\[
\begin{cases}
x = r \sin \theta \cos \phi,\\
y = r \sin \theta \sin \phi, \\
z = r \cos \theta, \\
\end{cases}
\]
Нам так же понадобится скалярное произведение в сферических координатах. Для этого посчитаем якобиан перехода из декартовой системы в сферическую:
\[
J = \left|\frac{\partial(x, y, z)}{\partial(r, \theta, \phi)}\right| = r^2\sin\theta
\]
Тогда, скалярное произведение запишется в виде:
\[
\bra{\psi}\ket{\phi} = \int\limits_{-\infty}^{+\infty}\int\limits_{-\infty}^{+\infty}\int\limits_{-\infty}^{+\infty}\psi^*(r)\phi(r)dxdydz= \int\limits_0^{2\pi}\int\limits_0^{\pi}\int\limits_0^{\infty}\psi^*(r)\phi(r)r^2\sin\theta dr d\theta d\phi
\]
На практике принято объединять пространства, связанные с угловым движением $\mathbf{Y} = \mathbf{V}_{\theta} + \mathbf{V}_{\phi}$ , и оставлять произведение \textit{радиальной} части и \textit{угловой} $\mathbf{V} = \mathbf{V}_r \otimes \mathbf{Y}$. Элементами этих пространств являются волновые функции радиуса $R(r)$ и волновые функции углов $Y(\theta, \phi)$. Для дальнейшего описания нам понадобится новый оператор -- оператор момента импульса.
\subsection{Оператор момента импульса.}
В соответствии с классическим подходом, введём понятие оператора момента импульса как:
\[
\hat{\Vec{L}} = \hat{\Vec{r}} \times \hat{\Vec{p}}
\]
или, если расписать покомпонентно, получим:
\begin{equation*}
\begin{split}
    \hat{L}_x = \hat{y}\hat{p}_z - \hat{z}\hat{p}_y\\
    \hat{L}_y = \hat{z}\hat{p}_x - \hat{x}\hat{p}_z\\
    \hat{L}_z = \hat{x}\hat{p}_y - \hat{y}\hat{p}_x
\end{split}
\end{equation*}
Давайте найдём все важные коммутаторы и оформим это в виде упражнения:
\excersize{Упражнение №23}{darklavender}
\begin{center}
    \textit{Найдите следующие коммутаторы: $[\hat{L}_j, \hat{r}_k]$, $[\hat{L}_j, \hat{p}_k]$, $[\hat{L}_j, \hat{L}_k]$, $[\hat{L}_j, \hat{r}^2]$, $[\hat{L}_j, \hat{p}^2]$, $[\hat{L}_j, \hat{L}^2]$.}
\end{center}
Для удобства записи вспомним, что такое \textit{символ Леви-Чивита}:
\[
\varepsilon_{ijk} = 
\begin{cases}
    1,\; \text{если чётность перестановки индексов \{i, j, k\} чётная};\\
    -1,\;\text{если чётность перестановки индексов \{i, j, k\} нечётная}; \\
    0,\;\text{иначе}.
\end{cases}
\]
Тогда оператор импульса можно переписать в виде $\hat{L}_j = \varepsilon_{jmn} \hat{r}_m \hat{p}_n$. Используя это обозначение, найдём первый коммутатор:
\begin{multline*}
    [\hat{L}_j, \hat{r}_k] = [\varepsilon_{jmn} \hat{r}_m \hat{p}_n, \hat{r}_k] = \varepsilon_{jmn} \hat{r}_m [\hat{p}_n, \hat{r}_k] = \varepsilon_{jmn}\hat{r}_m(-i\hbar)\delta_{nk} = (\text{сворачиваем } \varepsilon_{jmn}\delta_{nk} = \varepsilon_{jmk} \text{ и,} \\ \text{так как символ Леви-Чивита антисимметричный, заменим } \varepsilon_{jmk} = -\varepsilon_{jkm}) = i\hbar\varepsilon_{jkm}\hat{r}_m.
\end{multline*}
Аналогично с импульсом:
\[
[\hat{L}_j, \hat{p}_k] = [\varepsilon_{jmn} \hat{r}_m \hat{p}_n, \hat{p}_k] = \varepsilon_{jmn} \hat{p}_n [\hat{r}_m, \hat{p}_k] = i\hbar\varepsilon_{jmn}\hat{p}_n\delta_{mk} = i\hbar\varepsilon_{jkn}\hat{p}_n
\]
Сейчас придётся немножко помучиться с индексами, но нам не впервой, так что посчитаем третий коммутатор:
\begin{multline*}
    [\hat{L}_j, \hat{L}_k] = [\varepsilon_{jmn} \hat{r}_m \hat{p}_n, \varepsilon_{klq} \hat{r}_l\hat{p}_q] = \varepsilon_{jmn}\varepsilon_{klq}[\hat{r}_m \hat{p}_n, \hat{r}_l\hat{p}_q] = \varepsilon_{jmn}\varepsilon_{klq}(-i\hbar\delta_{nl}\hat{r}_m\hat{p}_q + i\hbar\delta_{mq}\hat{r}_l\hat{p}_n) = \\
    = -i\hbar\varepsilon_{jml}\varepsilon_{klq}\hat{r}_m\hat{p}_q + i\hbar\varepsilon_{jmn}\varepsilon_{klm}\hat{r}_l\hat{p}_n = -i\hbar\varepsilon_{ljm}\varepsilon_{lqk}\hat{r}_m\hat{p}_q + i\hbar\varepsilon_{mnj}\varepsilon_{mkl}\hat{r}_l\hat{p}_n = \\(\text{разворачиваем произведение символов Леви-Чивиты по формуле } \varepsilon_{ljm}\varepsilon_{lqk} = \delta_{jq}\delta_{mk} - \delta_{jk}\delta_{mq})= \\
    = -i\hbar(\delta_{jq}\delta_{mk} - \delta_{jk}\delta_{mq})\hat{r}_m\hat{p}_q + i\hbar(\delta_{nk}\delta_{jl} - \delta_{nl}\delta_{jk})\hat{r}_l\hat{p}_n = -i\hbar\hat{r}_k\hat{p}_j + i\hbar\delta_{jk}\hat{r}_m\hat{p}_m + i\hbar\hat{r}_j\hat{p}_k - i\hbar\delta_{jk}\hat{r}_l\hat{p}_l \\= -i\hbar\hat{r}_k\hat{p}_j + i\hbar\hat{r}_j\hat{p}_k.
\end{multline*}
Теперь давайте попробуем пойти обратным путём, т.е. выразить полученное выражение через произведение символов Леви-Чивиты. Причём мы хотим подобрать индексы так, чтобы в итоге можно было представить выражение как символ Леви-Чивиты, умноженный на оператор момента импульса.
\[
i\hbar\hat{r}_j\hat{p}_k - i\hbar\hat{r}_k\hat{p}_j = i\hbar(\delta_{jm}\delta_{kn} - \delta_{jn}\delta_{km})\hat{r}_n\hat{p}_m = i\hbar\varepsilon_{ljk}\varepsilon_{lmn}\hat{r}_n\hat{p}_m = i\hbar\varepsilon_{ljk}\hat{L}_q
\]
Приравнивая, получим (тут циклически были переставлены индексы в символе Леви-Чивита для красоты записи):
\[
[\hat{L}_j, \hat{L}_k] = i\hbar\varepsilon_{jkl}\hat{L}_l
\]
Полпути пройдено, осталось посчитать коммутатор с квадратами операторов. Приступим:
\[
[\hat{L}_j, \hat{r}^2] = [\hat{L}_j, \hat{r}_k\hat{r}_k] = 2i\hbar\varepsilon_{jkl}\hat{r}_k\hat{r}_l
\]
Индексы k и l -- немые, значит мы можем менять их как хотим. Давайте поменяем их местами. С одной стороны, это нечётная перестановка, значит $\varepsilon_{jkl} = -\varepsilon_{jlk}$. С другой стороны, операторы координаты коммутируют, а значит $2i\hbar\varepsilon_{jkl}\hat{r}_k\hat{r}_l = 2i\hbar\varepsilon_{jlk}\hat{r}_k\hat{r}_l$. Получается, что единственный вариант, когда это выполняется -- когда это выражение равно нулю.
\[
[\hat{L}_j, \hat{r}^2] = [\hat{L}_j, \hat{r}_k\hat{r}_k] = 0
\]
С импульсом аналогично:
\[
[\hat{L}_j, \hat{p}^2] = 2i\hbar\varepsilon_{jkl}\hat{p}_k\hat{p}_l = 0
\]
Вы удивитесь, но то же самое работает и для момента импульса:
\[
[\hat{L}_j, \hat{L}^2] = 2i\hbar\varepsilon_{jkl}\hat{L}_k\hat{L}_l = 0
\]
Последнее выражение играет важную роль, так как это значит, что в системе могут быть одновременно определены и компонента момента импульса, и его квадрат.
\csquare{darklavender}

Может возникнуть вопрос: для чего мы искали коммутатор с квадратом импульса и координаты? Оказывается, что из факта коммутации оператора момента импульса с ними, мы можем получить, что в случае центрально-симметричного потенциала гамильтониан коммутирует с каждой из компонент и квадратом момента импульса. Действительно, гамильтониан равен: 
\[
\hat{H} = \frac{\hat{p}^2}{2M} + V(\sqrt{\hat{r}^2}).
\]
Коммутация с квадратами как раз показывает, что $[\hat{H}, \hat{L}_i] = 0$ и $[\hat{H}, \hat{L}^2] = 0$. Теперь давайте выразим уравнение Шрёдингера через момент импульса. Для этого нам понадобится связь квадрата момента импульса с операторами импульса и координаты:
\[
\hat{L}^2 = \hat{r}^2\hat{p}^2 - (\hat{\Vec{r}}\hat{\Vec{p}})^2 + i\hbar\hat{\Vec{r}}\hat{\Vec{p}}.
\]
Вывести это можно, честно расписав $\hat{L}^2$ как $\hat{L}_j\hat{L}_k = (\varepsilon_{jlm}\hat{r}_l\hat{p}_m)(\varepsilon_{knq}\hat{r}_n\hat{p}_q)$. Умножив стационарное уравнение Шрёдингера на $\hat{r}^2$ и заменив $\hat{r}^2\hat{p}^2$ на $\hat{L}^2 + (\hat{\Vec{r}}\hat{\Vec{p}})^2 - i\hbar\hat{\Vec{r}}\hat{\Vec{p}}$ , получим:
\[
\left[\frac{(\hat{\Vec{r}}\hat{\Vec{p}})^2 - i\hbar\hat{\Vec{r}}\hat{\Vec{p}}}{2M} + \frac{\hat{L}^2}{2M} + \hat{r}^2 V(\Vec{r})\right]\psi(\Vec{r}) = \hat{r}^2 E\psi(\Vec{r})
\]
Можно заметить, что у нас разделились переменные: первое слагаемое влияет только на радиальную часть, второе -- на вращательную, а третье тоже на радиальную, если потенциал вращательно инвариантен, т.е. $V(\Vec{r}) = V(r)$. Но это пока не показано строго, так как мы работаем в сферических координатах, а значит должны перейти к ним.
\excersize{Упражнение №24}{darklavender}
\begin{center}
    \textit{Найдите представление операторов $\hat{L}^2$, $\hat{\Vec{r}}\hat{\Vec{p}}$ и $(\hat{\Vec{r}}\hat{\Vec{p}})^2$ в сферических координатах.}
\end{center}
Расписав компоненту $\hat{L}_j$ в координатном базисе, получим 
\[
\hat{L}_j = -i\hbar\varepsilon_{jkl}r_k\frac{\partial}{\partial r_l}
\]
Далее я подробно буду расписывать случай только для координаты z, для всех остальных вариантов можно проверить выражения по аналогии. Запишем дифференциал в новых координатах:
\[
\frac{\partial }{\partial z} = \frac{\partial}{\partial r}\frac{\partial r}{\partial z} + \frac{\partial}{\partial \theta}\frac{\partial \theta}{\partial z} + \frac{\partial}{\partial \phi}\frac{\partial \phi}{\partial z}
\]
Выразим переменные сферических координат через переменные декартовых:
\begin{equation*}
    \begin{cases}
        x = r\sin\theta\cos\phi\\
        y = r\sin\theta\sin\phi\\
        z = r\cos\theta
    \end{cases}
    =>
    \begin{cases}
        r = \sqrt{x^2 + y^2 + z^2}\\
        \theta = arccos(\frac{z}{r})\\
        \phi = arctg(\frac{y}{x})
    \end{cases}
\end{equation*}
Тогда, честно дифференцируя и выражая результат в сферических координатах, найдём:
\[
\frac{\partial r}{\partial z} = \frac{z}{\sqrt{x^2 + y^2 + z^2}} = \cos\theta.
\]
\[
\frac{\partial \theta}{\partial z} = \frac{-(x^2+y^2)}{\sqrt{\frac{x^2 + y^2}{x^2+y^2+z^2}}(x^2+y^2+z^2)^{3/2}}= -\frac{r^2\sin^2\theta}{\sqrt{\frac{r^2\sin^2\theta}{r^2}}r^3} = -\frac{\sin\theta}{r} 
\]
\[
\frac{\partial \phi}{\partial z} = 0
\]
Выпишу значение производных по оставшимся компонентам, чтобы читатели могли проверить себя:
\[
\frac{\partial r}{\partial x} = \sin\theta\cos\phi; \; \frac{\partial \theta}{\partial x} = \frac{1}{r}\cos\theta\cos\phi; \; \frac{\partial \phi}{\partial x} = -\frac{1}{r}\frac{\sin\phi}{\sin\theta}.
\]
\[
\frac{\partial r}{\partial y} = \sin\theta\sin\phi; \; \frac{\partial \theta}{\partial y} = \frac{1}{r}\cos\theta\sin\phi; \; \frac{\partial \phi}{\partial y} = \frac{1}{r}\frac{\cos\phi}{\sin\theta}.
\]
Теперь, зная все необходимые частные производные, подставим их в изначальное уравнение и получим:
\[
\frac{\partial }{\partial x} = \sin\theta\cos\phi\frac{\partial}{\partial r} + \frac{1}{r}\cos\theta\cos\phi\frac{\partial}{\partial \theta} -\frac{1}{r}\frac{\sin\phi}{\sin\theta}\frac{\partial}{\partial\phi}
\]
\[
\frac{\partial }{\partial y} = \sin\theta\sin\phi\frac{\partial}{\partial r} + \frac{1}{r}\cos\theta\sin\phi\frac{\partial}{\partial \theta} +\frac{1}{r}\frac{\cos\phi}{\sin\theta}\frac{\partial}{\partial\phi}
\]
\[
\frac{\partial }{\partial z} = \cos\theta\frac{\partial}{\partial r} -\frac{\sin\theta}{r}\frac{\partial}{\partial \theta}
\]
Подставим эти значения в компоненты момента импульса:
\begin{multline*}
\hat{L}_z = -i\hbar(x\frac{\partial}{\partial y} - y\frac{\partial}{\partial x}) = -i\hbar\left(r\sin\theta\cos\phi\left(\sin\theta\sin\phi\frac{\partial}{\partial r} + \frac{1}{r}\cos\theta\sin\phi\frac{\partial}{\partial \theta} +\frac{1}{r}\frac{\cos\phi}{\sin\theta}\frac{\partial}{\partial\phi}\right) - ...\right) = \\
= \left(r\sin^2\theta \cos\phi \sin\phi \frac{\partial}{\partial r} - r\sin^2\theta\cos\phi\sin\phi\frac{\partial}{\partial r} = 0. \text{ Аналогично, второй член сократится}\right) =\\ = -i\hbar\left(r\sin\theta\cos\phi\frac{1}{r}\frac{\cos\phi}{\sin\theta}\frac{\partial}{\partial \phi} + r\sin\theta\sin\phi\frac{1}{r}\frac{\sin\phi}{\sin\theta}\frac{\partial}{\partial \phi} \right) = -i\hbar \left(\cos^2\phi+\sin^2\phi\right)\frac{\partial}{\partial \phi} = -i\hbar\frac{\partial}{\partial \phi}
\end{multline*}
Аналогично, для других компонент:
\[
\hat{L}_x = i\hbar\left(\sin\phi\frac{\partial}{\partial \theta} + ctg\,\theta\cos\phi \frac{\partial}{\partial \phi}\right)
\]
\[
\hat{L}_x = i\hbar\left(-\cos\phi\frac{\partial}{\partial \theta} + ctg\,\theta\sin\phi \frac{\partial}{\partial \phi}\right)
\]
Далее найдём квадрат момента импульса, записав его как: $\hat{L}^2 = \hat{L}^2_x + \hat{L}^2_y + \hat{L}^2_z$:
\[
\hat{L}^2 = -\hbar^2\left[\frac{1}{\sin\theta}\frac{\partial}{\partial \theta}\left( \sin\theta\frac{\partial}{\partial \theta} \right) + \frac{1}{\sin^2\theta}\frac{\partial^2}{\partial\phi^2}\right]
\]
Используя производные в сферических координатах, найдём операторы $\hat{\Vec{r}}\hat{\Vec{p}}$ и $(\hat{\Vec{r}}\hat{\Vec{p}})^2$:
\[
\hat{\Vec{r}}\hat{\Vec{p}} = -i\hbar\frac{\partial}{\partial r}
\]
\[
(\hat{\Vec{r}}\hat{\Vec{p}})^2 = -\hbar^2\left( r^2\frac{\partial^2}{\partial r^2} + r\frac{\partial}{\partial r}\right)
\]
\csquare{darklavender}

Посмотрев на получившиеся операторы, сразу можно заметить, что наше предположение о разделении переменных оказалось верным. Действительно, операторы $\hat{\Vec{r}}\hat{\Vec{p}}$ и $(\hat{\Vec{r}}\hat{\Vec{p}})^2$ содержат в себе только радиальную часть, а $\hat{L}^2$ , наоборот, зависит только от углов. Также мы показали, что оператор $\hat{L}^2$ коммутирует с гамильтонианом. Казалось бы, ну и отлично, давайте будем искать решения уравнений Шрёдингера в собственных состояниях квадрата момента импульса. Однако на деле не всё так просто. Проблема в том, что оператор $\hat{L}^2$, как мы выяснили ранее, локален в $\mathbf{Y}$. Это значит, что собственные состояния эквивалентного для него оператора во всём пространстве $\hat{1}\otimes\hat{L}^2$ имеют собственные состояния $\ket{R}\otimes\ket{\lambda}$, где $\ket{\lambda}$ -- собственное состояния оператора $\hat{L}^2$ в $\mathbf{Y}$, а $\ket{R}$ -- произвольное (!) состояние в $\mathbf{V}_r$. Эта произвольность как раз и мешает нам находить решение в таком виде -- сильная вырожденность собственных значений оператора $\hat{1}\otimes\hat{L}^2$ не даёт нам уверенности в том, что случайно выбранное состояние вида $\ket{R}\otimes\ket{\lambda}$ будет собственным для гамильтониана. Получается, из всего многообразия таких состояний нам нужно отобрать те, которые являются собственными для гамильтониана. Для этого подставим найденные в сферических координатах операторы в уравнение Шрёдингера, запишем волновую функцию как $\psi(r, \theta, \phi) = R(r)Y_{\lambda}(\theta, \phi)$ и заменим оператор $\hat{L}^2$ на его собственное значение: 
\[
\left[-\frac{\hbar^2}{2Mr^2}\left( r^2\frac{\partial^2}{\partial r^2} + 2r\frac{\partial}{\partial r} \right)  + \frac{\lambda}{2M} + r^2V(r)\right]R(r)Y_{\lambda}(\theta, \phi) = r^2ER(r)Y_{\lambda}(\theta, \phi).
\]
Тогда, переписывая $r^2\frac{\partial^2}{\partial r^2} + 2r\frac{\partial}{\partial r}$ как $\frac{\partial}{\partial r}\left( r^2 \frac{\partial}{\partial r}\right)$ и сокращая $Y_{\lambda}(\theta, \phi)$, получим так называемое \textit{радиальное уравнение}:
\[
\left[-\frac{\hbar^2}{2Mr^2}\frac{\partial}{\partial r}\left( r^2 \frac{\partial}{\partial r}\right)  + \frac{\lambda}{2Mr^2} + V(r)\right]R(r) = ER(r).
\]
Получается, что, если радиальная часть волновой функции $\psi(r, \theta, \phi) = R(r)Y_{\lambda}(\theta, \phi)$ удовлетворяет радиальному уравнению, то эта волновая функция является собственное для гамильтониана с собственным значением E. Таким образом, мы разделили задачу на две: нахождение собственных значений $\hat{L}^2$ (приведение к диагональному виду) и решения диффура. Первую часть задачу достаточно решить один раз. Этим мы и займёмся в следующем семинаре.