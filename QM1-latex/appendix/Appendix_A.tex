\setcounter{figure}{0}  
\begin{center}
    \section{Приложение А}\label{appendix:A}
    \textbf{\Large{Нахождение собственных функций операторов $\hat{L}^2$ и $\hat{L}_z$}}
\end{center}

Найдём волновые функции состояния $\ket{lm}$. Для начала напишем вид операторов повышения и понижения в координатном базисе:
\begin{gather*}
\hat{L}_+ \simeq \hbar e^{i\phi}\left(\frac{\partial}{\partial \theta} + i \ctg\theta\,\frac{\partial}{\partial \phi} \right)\\
\hat{L}_- \simeq \hbar e^{-i\phi}\left(-\frac{\partial}{\partial \theta} + i \ctg\theta\,\frac{\partial}{\partial \phi} \right)
\end{gather*}

В каком виде нам искать решения для нашего уравнения? Здесь нам помогут уравнения математической физики и определенные там \textit{сферические функции}. Выпишем их и докажем с помощью математической индукции, что они действительно являются собственными функциями в рассматриваемой системе:
\[
Y^m_l(\theta, \phi) = \mathcal{N}_l\sqrt{\frac{(l+m)!}{(l-m)!}} \frac{1}{\sin^{m}\theta}\,\frac{d^{l-m}}{d(\cos\theta)^{l-m}}\sin^{2l}\theta e^{im\phi},
\]
где $\mathcal{N}_l = (-1)^l \sqrt{\frac{2l+1}{4\pi}}\frac{1}{2^l l!}$ - коэффициент нормировки.

Доказательство построим в 4 шага. Для начала покажем, что при действии оператора повышения на состояние $\ket{ll}$ (то есть $m = l$) мы получим 0. На втором шаге убедимся в том, что правильно определили нормирующий множитель. На третьем шаге применим к сферической функции при $m = l$ оператор $\hat{L}^2$ и убедимся, что функции являются собственными с собственным значением $\hbar^2(l+1)l$. В конце сделаем шаг математической индукции: предположим, что состояние $\ket{lm}$ задаётся сферической функцией и покажем, что состояние $\ket{l, m-1}$ так же задаётся сферической функцией.

\begin{enumerate}
    \item При $m = l$ сферические функции имеют вид: 
    \[
    Y^l_l(\theta, \phi) = \mathcal{N}_l\sqrt{(2l)!}\sin^l \theta\, e^{il\phi}.
    \]
    Подействуем на неё повышающим оператором:
    \begin{align*}
        \hat{L}_+\ket{ll} & \simeq \hbar e^{i\phi}{N}_l\sqrt{(2l)!}\left(\frac{\partial}{\partial \theta} + i \ctg\theta\,\frac{\partial}{\partial \phi} \right)\sin^{l}\theta\,e^{i l \phi} = \\
        & = \hbar e^{i\phi}{N}_l\sqrt{(2l)!}\left( l\cos\theta\sin^{l-1}\theta - l\ctg\theta\sin^l\theta\, e^{i l \phi} \right) =\\
        & = 0
    \end{align*}
    \item Для проверки нормировки приравняем скалярное произведение состояния на самого себя к единице:
    \begin{align*}
        \braket{ll} & = \int\limits_0^{2\pi}\int\limits_0^{\pi}\left|Y^l_l(\theta, \phi)\right|^2 \sin\theta \, d\theta d\phi = \mathcal{N}^2_l(2l)!\int\limits_0^{2\pi}\int\limits_0^{\pi}\sin^{2l}\theta \sin\theta\,d\theta d\phi = \\
        & = (\text{сделаем замену } x = \cos\theta,\, dx = -\sin\theta\,d\theta, \text{ проинтегрируем по }\phi) =\\
        & = 2\pi\mathcal{N}^2_l(2l)!\int\limits_{-1}^1 \left(1-x^2\right)^l dx.
    \end{align*}
    Вычислим этот интеграл. В квадратурах, к сожалению, не получится -- решением будет бета-функция. Но мы люди подкованные, таких страшных слов не испугаемся! Напомню, что бета-функция имеет вид:
    \[
    B(x, y) = \int\limits_0^1 t^{x-1}\left(1-t\right)^{y-1}dt = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)}
    \]
    Приведём интеграл к похожему виду:
    \begin{align*}
        & \int\limits_{-1}^1 \left(1-x^2\right)^l dx = 2\int\limits_{0}^1 \left(1-x^2\right)^l dx = \left(z = x^2,\, dz = 2xdx\right) = \\
        & = \int\limits_{0}^1 z^{-\frac{1}{2}}\left(1-z\right)^l dz = B(1/2,\, l+1) = \frac{\Gamma(1/2)\Gamma(l+1)}{\Gamma(l+3/2)}.
    \end{align*}
    Теперь вспоминаем свойства гамма-функций. Во-первых, если $n$ -- целое, то \\$\Gamma(n+1) = n!$. Во-вторых, $\Gamma(n + 1/2) = \frac{(2n)!}{4^n n!}\sqrt{\pi}$. Если подставить $n+1$, то получим \\$\Gamma(n + 3/2) = \frac{(2n+2)!}{4^{n+1} (n+1)!}\sqrt{\pi}$. В-третьих, $\Gamma(1/2) = \sqrt{\pi}$. Воспользовавшись этими свойствами, найдём, чему равен интеграл:
    \begin{align*}
        \int\limits_{-1}^1 (1-x^2)^l dx = \frac{\Gamma(1/2)\Gamma(l+1)}{\Gamma(l+3/2)} = 4^{l+1}\frac{\sqrt{\pi} \, l! \, (l+1)!}{\sqrt{\pi}(2l+2)!} = 2^{2l + 1}\frac{(l!)^2}{(2l+1)!}
    \end{align*}
    Подставив это выражение, получим:
    \begin{align*}
         & 2\pi\mathcal{N}^2_l(2l)!\int\limits_{-1}^1 \left(1 - x^2\right)^l dx = 2\pi\mathcal{N}^2_l(2l)!\frac{2^{2l+1}(l!)^2}{(2l+1)!} = \\
         & = 4\pi\mathcal{N}^2_l\frac{2^{2l}(l!)^2}{(2l+1)} = 1 \implies \mathcal{N}_l = \sqrt{\frac{{2l+1}}{4\pi}}\frac{1}{2^ll!}
    \end{align*}
    Обычно перед коэффициентом нормировки добавляют $(-1)^{l}$.
    \item Посчитаем $\hat{L}^2\ket{ll}$. Напомню, что оператор $\hat{L}^2$ в координатном базисе имеет вид: 
    \[
    \hat{L}^2 \simeq -\hbar^2\left[\frac{1}{\sin\theta}\frac{\partial}{\partial \theta}\left( \sin\theta\frac{\partial}{\partial \theta} \right) + \frac{1}{\sin^2\theta}\frac{\partial^2}{\partial\phi^2}\right]
    \]
    Тогда, подставляя его в выражение, получим:
    \begin{align*}
        \hat{L}^2\ket{ll} & \simeq  -\mathcal{N}_l\sqrt{(2l)!} \hbar^2 \left[\frac{1}{\sin\theta} \frac{\partial}{\partial \theta} \left( \sin \theta \frac{\partial}{\partial \theta}\sin^l\theta \right)e^{i l \phi} + \sin^l\theta\frac{1}{\sin^2\theta}\frac{\partial^2}{\partial\phi^2} e^{i l \phi}\right] =\\
        & =  -\mathcal{N}_l\sqrt{(2l)!}\hbar^2\left[\frac{1}{\sin\theta}\frac{\partial}{\partial \theta}\left( l\cos\theta\sin^l\theta \right)e^{i l \phi} - l^2\sin^{l-2}\theta e^{i l \phi}\right] = \\
        & = -\mathcal{N}_l\sqrt{(2l)!}\hbar^2\left[\frac{l}{\sin\theta}\left(-\sin^{l+1}\theta + l\cos^2\theta\sin^{l-1}\theta\right) - l^2\sin^{l-2}\theta\right]e^{i l \phi} = \\
        & = -\mathcal{N}_l\sqrt{(2l)!}\hbar^2\left[-l\sin^{l}\theta + l^2 \cos^2\theta \sin^{l-2}\theta - l^2 \sin^{l-2}\theta \right] e^{i l \phi} = \\
        & = -\mathcal{N}_l\sqrt{(2l)!}\hbar^2\left[-l\sin^{l}\theta - l^2\sin^{l}\theta \right]e^{i\phi l} = \mathcal{N}_l\sqrt{(2l)!}\hbar^2\left[l(l + 1)\sin^l \theta \right]e^{i l \phi} = \\
        & = \hbar^2l(l+1)Y^l_l(\theta, \phi).
    \end{align*}
    Получилось как раз то, что нам нужно было: $\hat{L}^2 \ket{ll} = \lambda \ket{ll}$. На этом моменте мы подтвердили базу индукции.
    \item Осталось сделать шаг индукции. Пусть $\ket{lm}$ представим в виде сферической функции. Докажем, что $\ket{l,\, m-1}$ тоже имеет такой вид. Для этого подействуем на состояние $\ket{lm}$ понижающим оператором. Напомню, что в 8 семинаре мы показали, что состояние $\hat{L}_{\pm}\ket{lm}$ является собственным для операторов $\hat{L}^2$ и $\hat{L}_z$. Это позволяет нам спокойной использовать его для доказательства при переходе.
    \begin{align*}
        &\hat{L}_-\ket{lm} \simeq \hbar e^{-i\phi}\mathcal{N}_l\sqrt{\frac{(l+m)!}{(l-m)!}}\left(-\frac{\partial}{\partial \theta} + i \ctg\theta\,\frac{\partial}{\partial \phi} \right)  \frac{1}{\sin^{m}\theta}\,\frac{d^{l-m}}{d(\cos\theta)^{l-m}}\sin^{2l}\theta e^{im\phi} = \\
        & = \left(\frac{\partial}{\partial \theta} =  -\sin\theta \frac{\partial}{\partial \cos\theta}\right) = \hbar e^{-i\phi} \mathcal{N}_l \sqrt{\frac{(l+m)!}{(l-m)!}} \biggl(m\ctg\theta\sin^{-m}\theta\frac{d^{l-m}}{d(\cos\theta)^{l-m}}\sin^{2l}\theta + \\
        & + \sin^{-m}\theta \, \sin\theta \frac{d^{l-m+1}}{d(\cos\theta)^{l-m+1}} \sin^{2l}\theta - m\ctg\theta\sin^{-m}\theta\frac{d^{l-m}}{d(\cos\theta)^{l-m}} \sin^{2l}\theta \biggl)e^{im\phi} = \\
        & = \hbar\mathcal{N}_l\sqrt{\frac{(l+m)!}{(l-m)!}} \left( \sin^{-m+1}\theta \frac{d^{l-m+1}}{d(\cos\theta)^{l-m+1}} \sin^{2l}\theta \right) e^{i (m-1) \phi} = \\
        & =\hbar Y^{m-1}_l(\theta, \phi)\sqrt{(l+m)(l-m+1)}.
    \end{align*}
    Доказательство закончено.
\end{enumerate}